{% extends "base.html" %}

{% block title %}Peptide Library - Peptide Tracker{% endblock %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <h1 class="mb-0"><i class="bi bi-list-ul"></i> Peptide Library</h1>
  <a href="{{ url_for('compare') }}" class="btn btn-outline-primary">
    <i class="bi bi-bar-chart-fill"></i> Compare Peptides
  </a>
</div>

<p class="text-muted mb-4">
  Browse our comprehensive peptide database. Click any peptide for detailed information including dosing, benefits, and research links.
</p>

{% if peptides %}
<div class="row g-4">
  {% for peptide in peptides %}
  <div class="col-12 col-sm-6 col-md-4 col-lg-3">
    <a href="{{ url_for('peptide_detail', peptide_id=peptide.id) }}" class="text-decoration-none">
      <div class="card h-100 card-hover shadow-sm">
        <!-- Peptide Image -->
        <div class="ratio ratio-1x1 bg-light">
          {% if peptide.image_filename %}
            <img src="{{ url_for('static', filename='img/peptides/' + peptide.image_filename) }}" 
                 alt="{{ peptide.name }}" 
                 class="pep-img"
                 loading="lazy"
                 onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?><svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;400&quot; height=&quot;400&quot; viewBox=&quot;0 0 400 400&quot;><rect width=&quot;400&quot; height=&quot;400&quot; fill=&quot;%23f1f3f5&quot;/><text x=&quot;50%&quot; y=&quot;50%&quot; dominant-baseline=&quot;middle&quot; text-anchor=&quot;middle&quot; fill=&quot;%236c757d&quot; font-family=&quot;Arial&quot; font-size=&quot;18&quot;>{{ peptide.name }}</text></svg>';">
          {% else %}
            <div class="d-flex align-items-center justify-content-center bg-light h-100">
              <div class="text-center text-muted">
                <i class="bi bi-capsule" style="font-size: 3rem;"></i>
                <div class="mt-2 small">{{ peptide.name }}</div>
              </div>
            </div>
          {% endif %}
        </div>

        <!-- Peptide Info -->
        <div class="card-body">
          <h5 class="card-title mb-1">{{ peptide.name }}</h5>
          {% if peptide.common_name %}
          <div class="text-muted small mb-2">{{ peptide.common_name }}</div>
          {% endif %}

          {% if peptide.primary_benefits %}
          <p class="card-text small text-muted mb-2" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
            {{ peptide.primary_benefits }}
          </p>
          {% endif %}

          <!-- Tags/Badges -->
          <div class="d-flex flex-wrap gap-1 mb-2">
            {% if peptide.primary_route %}
            <span class="badge bg-primary badge-pill">{{ peptide.primary_route.value }}</span>
            {% endif %}
            {% if peptide.typical_dose_min %}
            <span class="badge bg-secondary badge-pill">{{ peptide.typical_dose_min }}-{{ peptide.typical_dose_max or peptide.typical_dose_min }} mcg</span>
            {% endif %}
          </div>
        </div>

        <div class="card-footer bg-transparent border-top-0 pt-0">
          <div class="d-flex justify-content-between align-items-center small text-muted">
            <span>
              {% if peptide.frequency_per_day %}
              {{ peptide.frequency_per_day }}x/day
              {% endif %}
            </span>
            <span class="text-primary">
              View Details <i class="bi bi-arrow-right"></i>
            </span>
          </div>
        </div>
      </div>
    </a>
  </div>
  {% endfor %}
</div>
{% else %}
<div class="alert alert-info text-center py-5">
  <i class="bi bi-inbox" style="font-size: 3rem;"></i>
  <h4 class="mt-3">No Peptides Found</h4>
  <p class="mb-0">The peptide database is empty. Contact support to add peptides.</p>
</div>
{% endif %}

{% endblock %}

{% block extra_css %}
<style>
.card-hover {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.card-hover:hover {
  transform: translateY(-5px);
  box-shadow: 0 0.5rem 1.5rem rgba(0,0,0,0.15) !important;
}
.pep-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
</style>
{% endblock %}
