{% extends "base.html" %}
{% block title %}Protocols{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-start mb-4">
  <div>
    <h1 class="mb-1">Protocols</h1>
    <p class="text-muted mb-0">Create and manage your active protocols.</p>
  </div>
  <a href="{{ url_for('add_protocol') }}" class="btn btn-primary">
    <i class="bi bi-plus-circle me-1"></i> New Protocol
  </a>
</div>

<!-- Beginner Protocols (Free) -->
<div class="d-flex align-items-center gap-2 mb-2">
  <h2 class="mb-0"><span class="me-1">‚≠ê</span> Beginner Protocols</h2>
  <span class="badge bg-success">Free</span>
</div>
<p class="text-muted">Educational starter templates. Click <strong>Start This Protocol</strong> to review and add it to your account.</p>

<div class="row g-3 mb-5">
  {% set starter = [
    {"title":"BPC-157 Healing Protocol","subtitle":"Body Protection Compound-157","dose":"250‚Äì500 mcg","freq":"1‚Äì2√ó per day","duration":"4‚Äì6 weeks","route":"Subcutaneous","benefits":["Muscle/tendon/ligament support","Gut support","Anti-inflammatory effects","Connective tissue recovery"],"template":"bpc157"},
    {"title":"TB-500 Recovery Protocol","subtitle":"Thymosin Beta-4","dose":"2‚Äì5 mg","freq":"2√ó per week (loading), then 1√ó/week","duration":"4‚Äì6 weeks loading, then maintenance","route":"Subcutaneous","benefits":["Tissue repair support","Inflammation reduction","Flexibility/joint mobility","Recovery from injuries"],"template":"tb500"},
    {"title":"Epitalon Sleep & Longevity Protocol","subtitle":"Epithalon (Epitalon)","dose": None,"freq":"Daily","duration":"10‚Äì20 days (cycle)","route":"Subcutaneous","benefits":["Sleep quality support","Circadian rhythm support","General longevity interest","Cycle-based use"],"template":"epitalon"},
    {"title":"GHK-Cu Skin & Repair Protocol","subtitle":"Copper Peptide (GHK-Cu)","dose":"1‚Äì3 mg","freq":"Daily","duration":"4‚Äì8 weeks","route":"Subcutaneous / topical (where applicable)","benefits":["Skin health support","Wound healing support","Hair/follicle support (reported)","General tissue support"],"template":"ghkcu"},
    {"title":"MT2 Tanning Protocol","subtitle":"Melanotan II (MT2)","dose":"100‚Äì300 mcg","freq":"Daily (titrate)","duration":"2‚Äì4 weeks (build), then maintenance","route":"Subcutaneous","benefits":["Tanning response (reported)","Sun exposure reduction goal","Titration-based approach","Maintenance dosing"],"template":"mt2"},
  ] %}
  {% for p in starter %}
  <div class="col-12 col-lg-6">
    <div class="card h-100 border-0 shadow-sm">
      <div class="card-header bg-primary text-white">
        <div class="d-flex align-items-center justify-content-between">
          <div class="fw-semibold">{{ p.title }}</div>
          <span class="badge bg-light text-dark">Starter</span>
        </div>
        <div class="opacity-75">{{ p.subtitle }}</div>
      </div>
      <div class="card-body">
        <div class="mb-2"><strong>Recommended Dosing</strong></div>
        <ul class="list-unstyled mb-3">
          <li><i class="bi bi-check-circle text-success me-2"></i><strong>Dose:</strong> {{ p.dose if p.dose else "Set in your protocol" }}</li>
          <li><i class="bi bi-check-circle text-success me-2"></i><strong>Frequency:</strong> {{ p.freq }}</li>
          <li><i class="bi bi-check-circle text-success me-2"></i><strong>Duration:</strong> {{ p.duration }}</li>
          <li><i class="bi bi-check-circle text-success me-2"></i><strong>Route:</strong> {{ p.route }}</li>
        </ul>

        <div class="mb-2"><strong>Primary Benefits</strong></div>
        <ul class="mb-3">
          {% for b in p.benefits %}
          <li>{{ b }}</li>
          {% endfor %}
        </ul>

        <div class="alert alert-warning mb-0">
          <i class="bi bi-exclamation-triangle me-2"></i>
          <strong>Note:</strong> Educational information only. Consult a healthcare professional before starting any peptide protocol.
        </div>
      </div>
      <div class="card-footer bg-white border-0 pt-0">
        <a class="btn btn-primary w-100" href="{{ url_for('add_protocol') }}?template={{ p.template }}">
          <i class="bi bi-plus-circle me-1"></i> Start This Protocol
        </a>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<!-- Advanced Protocols (Locked) -->
<div class="d-flex justify-content-between align-items-center mb-2">
  <h2 class="mb-0">Advanced Protocols</h2>
  <span class="badge bg-warning text-dark px-3 py-2" style="border-radius:999px;">
    <span class="me-1">‚≠ê</span>Paid Platinum Users Only
  </span>
</div>
<p class="text-muted">Locked protocol blends and advanced stacks are available in the paid Platinum tier.</p>

<div class="card border-0 shadow-sm mb-5">
  <div class="card-body d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-start gap-3">
      <div style="font-size:20px">üîí</div>
      <div>
        <div class="fw-semibold">GHKCu‚ÄìBPC Blend</div>
        <div class="text-muted">Upgrade to unlock full details and one‚Äëclick setup.</div>
      </div>
    </div>
    <a class="btn btn-outline-primary" href="#" role="button">Upgrade to Platinum</a>
  </div>
</div>

<!-- Your Active Protocols -->
<h2 class="mb-3">Your Active Protocols</h2>
{% if protocols and protocols|length > 0 %}
  <div class="row g-3">
    {% for protocol in protocols %}
      <div class="col-12 col-lg-6">
        <div class="card h-100 border-0 shadow-sm">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <div class="fw-semibold">{{ protocol.name }}</div>
                <div class="text-muted">{{ protocol.peptide.name }}</div>
              </div>
              <a class="btn btn-sm btn-outline-primary" href="{{ url_for('protocol_detail', protocol_id=protocol.id) }}">View</a>
            </div>
            <hr>
            <div class="text-muted">
              Dose: {{ protocol.dose_mcg }} mcg ‚Ä¢ {{ protocol.frequency_per_day }}√ó/day
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="card border-0 shadow-sm">
    <div class="card-body">
      No active protocols yet. <a href="{{ url_for('add_protocol') }}">Create one now</a>.
    </div>
  </div>
{% endif %}

{% endblock %}
